---
description: React/Next.js frontend patterns for RS School App client
globs: client/**/*.tsx, client/**/*.ts
alwaysApply: false
---

# RS App Client UI Patterns

## Module Structure

```
modules/<Feature>/
  components/     # Feature-specific UI
  hooks/          # Feature-specific hooks
  pages/          # Page components
  services/       # API wrappers
  data/           # Data fetching functions
  types.ts        # Feature types
  index.ts        # Barrel exports
```

## Do's

### Pages (Next.js routes)
- Keep `pages/*.tsx` as thin wrappers only
- Compose providers and render single module page component
- Delegate all logic to module components

### Components
- Use functional components with hooks exclusively
- Export as named exports (not default)
- One component per file as primary export
- Use `React.memo()` for components with expensive renders
- Prefer composition over complex prop drilling
- Keep components pure when possible

### Props
- Define with `type`, not `interface`

### State Management
- Minimize `useEffect` - use only when truly necessary
- Derive computed values instead of storing in state
- Lift state up rather than prop drilling
- Use context for cross-cutting concerns

### Hooks
- Use hooks from `react-use` or `ahooks` before writing custom
- Keep custom hooks focused and simple

### Services
- Initialize clients at module level (singleton pattern)
- Use OpenAPI client for `/api/v2/*`, axios services for legacy `/api/*`

### Ant Design
- Use `Form.useForm<T>()` with typed form values
- Use `Form.Item` with `rules` for validation
- Use `theme.useToken()` for theme colors and adapt to dark/light mode
- Use `clsx` for conditional class composition

### Styling
- Use CSS modules exclusively: `*.module.css`
- Co-locate styles with components

### Context
- Create with `createContext<T>({} as T)`
- Export consumer hook: `useXxx()`
- Provider handles loading/error states

## Don'ts

```tsx
// ❌ styled-jsx (deprecated)
<style jsx>{`.class { color: red; }`}</style>
// ✅ CSS modules
import styles from './Component.module.css';

// ❌ Default export
export default function Component() {}
// ✅ Named export
export function Component() {}

// ❌ Business logic in pages/
function Page() {
  const [data, setData] = useState();
  useEffect(() => { fetch() }, []);
}
// ✅ Thin wrapper
function Page() {
  return <SessionProvider><FeaturePage /></SessionProvider>;
}

// ❌ Unnecessary state (can be derived)
const [fullName, setFullName] = useState('');
useEffect(() => {
  setFullName(`${first} ${last}`);
}, [first, last]);
// ✅ Derive directly
const fullName = `${first} ${last}`;

// ❌ Service instance per render
function Component() {
  const service = new CoursesService();
}
// ✅ Module-level singleton
const coursesService = new CoursesService();

// ❌ Cross-module imports
import { X } from 'modules/OtherModule/components';
// ✅ Move to shared
import { X } from 'components/X';

// ❌ Manual axios for v2 API
await axios.get('/api/v2/courses');
// ✅ Generated OpenAPI client
await new CoursesApi().getCourses();

// ❌ Hardcoded colors
style={{ color: '#1890ff' }}
// ✅ Theme tokens
const { token } = theme.useToken();
style={{ color: token.colorPrimary }}
```
